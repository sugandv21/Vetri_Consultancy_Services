{% extends "accounts/base.html" %}
{% block content %}

<div class="container py-4">

  <h3 class="mb-4">My Consultant Sessions</h3>

  {% if sessions %}

    <div class="row g-4">
      {% for session in sessions %}
      <div class="col-md-6">

        <div class="card shadow-sm h-100">
          <div class="card-body">

            <h5 class="card-title">{{ session.topic }}</h5>

            <p class="text-muted small mb-2">
              Requested on {{ session.created_at }}
            </p>

            <p>{{ session.message }}</p>

            <hr>

            <strong>Status:</strong>
            <span class="
                {% if session.status == 'REQUESTED' %}text-warning
                {% elif session.status == 'SCHEDULED' %}text-primary
                {% elif session.status == 'COMPLETED' %}text-success
                {% else %}text-danger{% endif %}
            ">
              {{ session.get_status_display }}
            </span>

            {% if session.status == "ATTENDED" %}
  <div class="alert alert-info mt-3">
    Trainer completed session. Waiting for admin verification.
  </div>
{% endif %}

{% if session.status == "COMPLETED" %}
  <div class="mt-3 p-3 border rounded bg-light">

    <h6 class="mb-2 text-success">Trainer Feedback</h6>

    <p class="mb-0" style="white-space:pre-wrap;">
      {{ session.feedback|default:"No feedback available" }}
    </p>

  </div>
{% endif %}


            {% if session.meeting_link %}
              <div class="mt-3">
                <a href="{{ session.meeting_link }}" target="_blank"
                   class="btn btn-sm btn-success">
                  Join Meeting
                </a>
              </div>
            {% endif %}

          </div>
        </div>

      </div>
      {% endfor %}
    </div>

  {% else %}
    <p>No sessions requested yet.</p>
    <a href="{% url 'consultant_sessions' %}" class="btn btn-primary">
      Request a Session
    </a>
  {% endif %}

</div>

{% endblock %}
