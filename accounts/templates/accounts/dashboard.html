{% extends "accounts/base.html" %}

{% block content %}
<div class="container mt-4">
  <h2 class="mb-4">My Dashboard</h2>

  <div class="row">

    <!-- Saved Jobs -->
    <div class="col-12 col-md-6 col-lg-4 mb-3">
      <div class="card text-center shadow-sm h-100 border-primary">
        <div class="card-body bg-primary bg-opacity-10">
          <h5 class="card-title text-primary">Saved Jobs</h5>
          <p class="display-4 fw-bold text-primary">
            {{ saved_jobs_count }}
          </p>
          <a href="{% url 'saved_jobs' %}"
             class="btn btn-outline-primary btn-sm">
            View saved jobs
          </a>
        </div>
      </div>
    </div>

    <!-- Applications -->
    <div class="col-12 col-md-6 col-lg-4 mb-3">
      <div class="card text-center shadow-sm h-100 border-success">
        <div class="card-body bg-success bg-opacity-10">
          <h5 class="card-title text-success">Applications</h5>
          <p class="display-4 fw-bold text-success">
            {{ applications_count }}
          </p>
          <a href="{% url 'applications' %}"
             class="btn btn-outline-success btn-sm">
            View applications
          </a>
        </div>
      </div>
    </div>

    <!-- Trainings Enrolled -->
    <div class="col-12 col-md-6 col-lg-4 mb-3">
      <div class="card text-center shadow-sm h-100 border-warning">
        <div class="card-body bg-warning bg-opacity-10">
          <h5 class="card-title text-warning">Trainings Enrolled</h5>
          <p class="display-4 fw-bold text-warning">
            {{ enrolled_trainings_count }}
          </p>
          <a href="{% url 'training_list' %}"
             class="btn btn-outline-warning btn-sm">
            View trainings
          </a>
        </div>
      </div>
    </div>

  </div> <!-- END row -->

  <!-- MY TRAININGS SECTION -->
  <h4 class="mt-5">My Trainings</h4>

  <div class="table-responsive">
    <table class="table table-bordered align-middle">
      <thead class="table-light">
        <tr>
          <th>Training</th>
          <th>Mentor</th>
          <th>Training Link</th> 
          
          <th>Timing</th>
          <th>Certificate</th>
        </tr>
      </thead>

      <tbody>
        {% for e in enrollments %}
        <tr>
          <td>{{ e.training.title }}</td>

          <td>
            {{ e.mentor_name|default:"Not assigned" }}<br>
            <small class="text-muted">{{ e.mentor_email }}</small>
          </td>
          
          <td>
            {% if e.training_link %}
              <a href="{{ e.training_link }}"
                target="_blank"
                class="btn btn-sm btn-primary">
                Join
              </a>
            {% else %}
              <span class="text-muted">Link not shared</span>
            {% endif %}
          </td>


          <td>
            {{ e.course_timing|default:"To be announced" }}
          </td>

          <td>
            {% if not e.is_completed %}
              <span class="text-muted">
                Available after course completion
              </span>
            {% elif e.is_completed and not e.certificate %}
              <span class="text-warning">
                Certificate uploading soon
              </span>
            {% else %}
              <a href="{{ e.certificate.url }}"
                 class="btn btn-sm btn-success">
                Download
              </a>
            {% endif %}
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="4" class="text-center text-muted py-4">
            No trainings enrolled.
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

</div>
{% endblock %}
